CREATE TABLE IF NOT EXISTS restaurants (id uuid PRIMARY KEY, "name" VARCHAR(255) NOT NULL, description VARCHAR(255) NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS discounts (id uuid PRIMARY KEY, restaurant_id uuid NOT NULL, "name" VARCHAR(255) NOT NULL, percentage REAL NOT NULL, CONSTRAINT fk_discounts_restaurant_id__id FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE RESTRICT ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS restaurant_menus (id VARCHAR(36) PRIMARY KEY, restaurant_id uuid NOT NULL, discount_id VARCHAR(36) NULL, menu VARCHAR(255) NOT NULL, description VARCHAR(255) NOT NULL, price INT NOT NULL, is_sold_out BOOLEAN NOT NULL, CONSTRAINT fk_restaurant_menus_restaurant_id__id FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE RESTRICT ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS orders (id VARCHAR(36) PRIMARY KEY, restaurant_id uuid NOT NULL, customer_id VARCHAR(36) NOT NULL, status INT NOT NULL, postal_code VARCHAR(255) NOT NULL, prefecture VARCHAR(255) NOT NULL, city VARCHAR(255) NOT NULL, street VARCHAR(255) NOT NULL, building VARCHAR(255) NOT NULL, CONSTRAINT fk_orders_restaurant_id__id FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE RESTRICT ON UPDATE RESTRICT);
CREATE INDEX orders_status ON orders (status);
